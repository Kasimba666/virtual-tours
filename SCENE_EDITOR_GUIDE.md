# Руководство по редактированию сцен с параметрами камеры

## Обзор

В разделе "Управление турами" → "Редактирование сцены" теперь доступна функция синхронизации параметров камеры в реальном времени. Вы можете настраивать положение камеры в панораме и видеть изменения в инпутах, а затем сохранять эти параметры в базе данных.

## Как это работает

### 1. Загрузка панорамы

1. Откройте редактор сцены (`/tour/:id/scene/:sceneId`)
2. Загрузите панораму через кнопку "Загрузить панораму"
3. После загрузки панорама появится в разделе "Просмотр панорамы"

### 2. Настройка параметров камеры

#### Через инпуты:
- **Yaw (горизонталь)**: Угол поворота по горизонтали от -π до π
- **Pitch (вертикаль)**: Угол наклона по вертикали от -π/2 до π/2
- **FOV (угол обзора)**: Угол обзора камеры от 30° до 120°

#### Через панораму:
1. Перемещайте камеру в окне панорамы
2. Параметры автоматически обновляются в соответствующих инпутах
3. Вы можете видеть текущие значения в реальном времени

### 3. Сохранение параметров

1. Настройте желаемое положение камеры любым удобным способом
2. Нажмите кнопку **"Сохранить сцену"**
3. Все параметры (название, панорама, параметры камеры) будут сохранены в базе данных

## Особенности реализации

### Автоматическое восстановление
- При загрузке существующей сцены параметры камеры автоматически подставляются в инпуты
- При загрузке панорамы камера устанавливается в сохраненное положение

### Реальное время
- Движение камеры в панораме мгновенно отображается в инпутах
- Изменение значений в инпутах не влияет на положение камеры (только чтение)

### Валидация
- Инпуты имеют ограничения по диапазону значений
- Инпуты отключены, пока не загружена панорама

## Технические детали

### Сохранение данных

Параметры камеры сохраняются в базе данных в следующем формате:

```json
{
  "scenes": {
    "scene-1": {
      "name": "Гостиная",
      "panorama": "https://...",
      "startView": {
        "yaw": 1.57,
        "pitch": 0.2,
        "fov": 75
      },
      "hotspots": []
    }
  }
}
```

### События PanoramaViewer

- **@ready**: Срабатывает при загрузке панорамы, применяет сохраненные параметры камеры
- **@camera-move**: Срабатывает при движении камеры, обновляет значения в инпутах

### Параметры камеры

- **yaw**: Угол поворота по горизонтали (в радианах)
- **pitch**: Угол наклона по вертикали (в радианах)
- **fov**: Угол обзора камеры (в градусах)

## Пример использования

1. Пользователь загружает панораму в редактор сцены
2. Камера автоматически устанавливается в сохраненное положение (если параметры были сохранены ранее)
3. Пользователь перемещает камеру, чтобы найти оптимальный вид
4. В инпутах отображаются текущие параметры камеры
5. Пользователь нажимает "Сохранить сцену"
6. Все изменения, включая параметры камеры, сохраняются в базе данных

## Преимущества новой реализации

- **Наглядность**: Видно точные значения параметров камеры
- **Удобство**: Можно настраивать камеру как через панораму, так и через инпуты
- **Точность**: Возможность ввода точных значений вручную
- **Интеграция**: Параметры камеры сохраняются вместе с другими данными сцены
- **Реальное время**: Мгновенное отображение изменений